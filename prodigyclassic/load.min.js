"use strict";var SW=SW||{};SW.Load={};var prodigyWeb={};SW.Load.sendLoadStart=function(){window.loadStartTime=Date.now();var e=window.loadStartTime;"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),window.uuid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)});var t=window.location.host,n=window.location.search,o="dev",i=SW.Load.getServiceURL();t.indexOf("-qa")>=0||t.indexOf("dev.prodigygame.org")>=0?o="local":t.indexOf("prodigygame.net")>=0||n.indexOf("env=dev")>=0?o="dev":t.indexOf("prodigygame.org")>=0||n.indexOf("env=staging")>=0?o="staging":(t.indexOf("prodigygame.com")>=0||n.indexOf("env=production")>=0||n.indexOf("env=prod")>=0)&&(o="production");var a,r="unknown",d=window.navigator.userAgent;d.indexOf("Opera")>-1||d.indexOf("OPR")>-1?r="Opera":d.indexOf("Chrome")>-1?r="Chrome":d.indexOf("Safari")>-1?r="Safari":d.indexOf("Firefox")>-1?r="Firefox":d.indexOf("SamsungBrowser")>-1?r="Samsung Internet for Android":d.indexOf("Trident")>-1?r="Internet Explorer":d.indexOf("Edge")>-1?r="Microsoft Edge":d.indexOf("Silk")>-1&&(r="Amazon Silk"),a=/iPad|iPhone|iPod/.test(navigator.platform)?/nativeApp/.test(window.location.href)?"iOS-App":"iOS-Browser":/Android/.test(navigator.platform)?/nativeApp/.test(window.location.href)?"Android-App":"Android-Browser":"Desktop-Browser";var s={name:"anonymous_game_complete_v3",version:3,uuid:window.uuid,timestamp:window.loadStartTime,timezone_offset:(new Date).getTimezoneOffset(),client_version:o,device_platform:a,browser:r,meta:{type:"login_screen_funnel",name:"load_start"}};i=i.concat("events-api/v3/anonymous-events");var c=new XMLHttpRequest;c.open("POST",i),c.setRequestHeader("Content-Type","application/json"),c.send(JSON.stringify({events:JSON.stringify([s])}))},SW.Load.setupGoogleEnvironment=function(){window.prodigyGoogleClientId=prodigyGoogleClientId},SW.Load.getUrlVars=function(){var e={};decodeURIComponent(window.location.href).replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,n,o){e[n]=o.replace(/\+/g," ")});return e},SW.Load.getUrlVar=function(e){var t=SW.Load.getUrlVars();for(var n in t)if(n==e)return t[n];return!1},SW.Load.loadGameBundles=function(){SW.LoadGameBundle.initialize()},SW.Load.getServiceURL=function(){return prodigyServiceUrl},SW.Load.getWebURL=function(){return prodigyWebUrl},SW.Load.getGameStatus=function(){var e=3;!function t(){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE)if(200===this.status){var o=n.response.data,i=SW.Load.getUrlVar("feature")||"",a=SW.Load.getUrlVar("release")||"",r="undefined"!=typeof prodigyGameCodePath?prodigyGameCodePath:o.gameCodePath;window.gameApiStatusData=o,i&&(r=(r=r.replace("dev","feature/"+i)).replace("staging","feature/"+i)),a&&(r=r.replace(/production(.*)/,"production/"+a+"/"));var d=r+"game.min.js?v="+o.gameClientVersion;"undefined"!=typeof prodigyGameCodeFile&&(d=prodigyGameCodeFile),window.gameCodeFile=d;var s=document.createElement("link");s.relList&&s.relList.supports("preload")&&(s.href=d,s.rel="preload",s.as="script",document.head.appendChild(s)),window.waitingOnResponse&&(SW.Load.loadGameBundles(),window.waitingOnResponse=!1)}else e>0?(e--,t()):(SW.Load.setErrorScreenText(),SW.Load.toggleErrorScreen(!0))};var o=SW.Load.getServiceURL()+"game-api";n.responseType="json",n.open("GET","https://raw.githubusercontent.com/craftersshaft/craftersshaft.github.io/master/prodigyclassic/status.json",!0),n.send("")}()},SW.Load.getEducationStatus=function(){var e=3;!function t(){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE)if(200===this.status){var o,i,a=n.response.data;"iOS"!==SW.Device.getOS()&&"Android"!==SW.Device.getOS()&&!SW.Device.isNativeApp()||SW.Device.isTablet()?(o=_.find(a,{id:"question-renderer"}).path,i=_.find(a,{id:"desktop-question-interface"}).path):(o=_.find(a,{id:"mobile-question-renderer"}).path,i=_.find(a,{id:"mobile-question-interface"}).path),window.questionRendererURL=o,window.questionInterfaceURL=i}else e>0?(e--,t()):(SW.Load.setErrorScreenText(),SW.Load.toggleErrorScreen(!0))};var o=SW.Load.getServiceURL()+"education-api";n.responseType="json",n.open("GET",o+"/v1/frontend-paths",!0),n.send("")}()},SW.Load.loadGame=function(){window.onload=function(){document.addEventListener("contextmenu",function(e){e.preventDefault()},!1)},window.onresize=function(){scroll(0,0)},prodigyWeb.membershipFlow={$el:$("#membership-flow"),$game:$("#game-wrapper"),student:{name:void 0,userID:void 0},closeCallback:void 0,open:function(e,t,n,o,i,a,r,d){var s=function(e){_.isObject(e.data)&&"membership-iframe-closed"===e.data.type&&(window.removeEventListener("message",s),this.close(e.data.success))}.bind(this);window.addEventListener("message",s);var c=SW.Load.getWebURL()+"Membership?game=1&tag="+o+"&username="+e+"&id="+t+"&funnelName="+i+"&isPlayingFromHome="+a+"&metaData="+r+"&token="+d,p=$('<iframe src="'+c+'">');this.student.name=e,this.student.userID=t,this.closeCallback=n,this.$el.show().append(p),this.$game.hide()},close:function(e){this.$el.hide().html(""),this.$game.show(),window.postMessage(JSON.stringify({name:"membership-flow-closed",success:e}),"*"),_.isUndefined(this.closeCallback)||this.closeCallback(e)}},window.gameApiStatusData?SW.Load.loadGameBundles():window.waitingOnResponse=!0},SW.Load.getDeviceInformationFromAPI=function(){if(!SW.Storage.get("device-information")){var e=new XMLHttpRequest,t=SW.Load.getServiceURL()+"device-detect-api/v1/information?";t=t+"user_agent="+navigator.userAgent,"undefined"!=typeof DeviceAtlas&&(t=t+"&properties="+encodeURIComponent(DeviceAtlas.getPropertiesAsString())),e.onreadystatechange=function(){if(e.readyState===XMLHttpRequest.DONE&&200===this.status){var t=e.response;t&&t.model&&SW.Storage.set("device-information",e.response)}},e.responseType="json",e.open("GET",t,!0),e.send("")}},SW.Load.setLoadingVisible=function(e){document.getElementById("game-loading-container-div").style.cssText=e?"":"display: none;"},SW.Load.ERROR_TITLE_DEFAULT="Uh oh! We were unable to connect to the Prodigy servers.",SW.Load.ERROR_DESCRIPTION_DEFAULT='Please ensure that you are connected to the Internet, and try reloading the page.<br>If this message persists, please email our <a href="mailto:support@prodigygame.com" class="text-white"><strong><u>support team</u></strong></a> or visit our <a href="https://twitter.com/prodigygame" class="text-white"><u><strong>status page</strong></u></a> for more details.',SW.Load.isErrorScreen=function(){return"none"!==document.getElementById("error-div").style.display},SW.Load.toggleErrorScreen=function(e){document.getElementById("error-div").style.cssText=e?"":"display: none;",document.getElementById("loading-div").style.cssText=e?"display: none;":""},SW.Load.setErrorScreenText=function(e,t){var n=document.getElementById("error-div-title");n.innerHTML=e||SW.Load.ERROR_TITLE_DEFAULT;var o=document.getElementById("error-div-description");o.innerHTML=t||SW.Load.ERROR_DESCRIPTION_DEFAULT};
